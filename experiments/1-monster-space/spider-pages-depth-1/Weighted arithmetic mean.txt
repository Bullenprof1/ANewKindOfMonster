statistical amount "Weighted mean" redirects here. For another use, see Weighted geometric mean. "Weighted average" redirects here. It is not to be confused with Weighted median. The weighted arithmetic mean is similar to an ordinary arithmetic mean (the most common type of average), except that instead of each of the data points contributing equally to the final average, some data points contribute more than others. The notion of weighted mean plays a role in descriptive statistics and also occurs in a more general form in several other areas of mathematics. If all the weights are equal, then the weighted mean is the same as the arithmetic mean. While weighted means generally behave in a similar fashion to arithmetic means, they do have a few counterintuitive properties, as captured for instance in Simpson's paradox. Contents 1 Examples 1.1 Basic example 1.2 Convex combination example 2 Mathematical definition 3 Statistical properties 4 Variance weights 4.1 Correcting for over- or under-dispersion 5 Bootstrapping validation 6 Weighted sample variance 6.1 Frequency weights 6.2 Reliability weights 7 Weighted sample covariance 7.1 Frequency weights 7.2 Reliability weights 8 Vector-valued estimates 9 Accounting for correlations 10 Decreasing strength of interactions 11 Exponentially decreasing weights 12 Weighted averages of functions 13 See also 14 References 15 Further reading 16 External links Examples[edit] Basic example[edit] Given two school classes, one with 20 students, and one with 30 students, the grades in each class on a test were: Morning class = 62, 67, 71, 74, 76, 77, 78, 79, 79, 80, 80, 81, 81, 82, 83, 84, 86, 89, 93, 98 Afternoon class = 81, 82, 83, 84, 85, 86, 87, 87, 88, 88, 89, 89, 89, 90, 90, 90, 90, 91, 91, 91, 92, 92, 93, 93, 94, 95, 96, 97, 98, 99 The mean for the morning class is 80 and the mean of the afternoon class is 90. The unweighted mean of the two means is 85. However, this does not account for the difference in number of students in each class (20 versus 30); hence the value of 85 does not reflect the average student grade (independent of class). The average student grade can be obtained by averaging all the grades, without regard to classes (add all the grades up and divide by the total number of students): x ¯ = 4300 50 = 86. {\displaystyle {\bar {x}}={\frac {4300}{50}}=86.} Or, this can be accomplished by weighting the class means by the number of students in each class. The larger class is given more "weight": x ¯ = ( 20 × 80 ) + ( 30 × 90 ) 20 + 30 = 86. {\displaystyle {\bar {x}}={\frac {(20\times 80)+(30\times 90)}{20+30}}=86.} Thus, the weighted mean makes it possible to find the mean average student grade without knowing each student's score. Only the class means and the number of students in each class are needed. Convex combination example[edit] Since only the relative weights are relevant, any weighted mean can be expressed using coefficients that sum to one. Such a linear combination is called a convex combination. Using the previous example, we would get the following weights: 20 20 + 30 = 0.4 {\displaystyle {\frac {20}{20+30}}=0.4} 30 20 + 30 = 0.6 {\displaystyle {\frac {30}{20+30}}=0.6} Then, apply the weights like this: x ¯ = ( 0.4 × 80 ) + ( 0.6 × 90 ) = 86. {\displaystyle {\bar {x}}=(0.4\times 80)+(0.6\times 90)=86.} Mathematical definition[edit] Formally, the weighted mean of a non-empty finite multiset of data { x 1 , x 2 , … , x n } , {\displaystyle \{x_{1},x_{2},\dots ,x_{n}\},} with corresponding non-negative weights { w 1 , w 2 , … , w n } {\displaystyle \{w_{1},w_{2},\dots ,w_{n}\}} is x ¯ = ∑ i = 1 n w i x i ∑ i = 1 n w i , {\displaystyle {\bar {x}}={\frac {\sum \limits _{i=1}^{n}w_{i}x_{i}}{\sum \limits _{i=1}^{n}w_{i}}},} which expands to: x ¯ = w 1 x 1 + w 2 x 2 + ⋯ + w n x n w 1 + w 2 + ⋯ + w n . {\displaystyle {\bar {x}}={\frac {w_{1}x_{1}+w_{2}x_{2}+\cdots +w_{n}x_{n}}{w_{1}+w_{2}+\cdots +w_{n}}}.} Therefore, data elements with a high weight contribute more to the weighted mean than do elements with a low weight. The weights cannot be negative. Some may be zero, but not all of them (since division by zero is not allowed). The formulas are simplified when the weights are normalized such that they sum up to 1 {\displaystyle 1} , i.e.: ∑ i = 1 n w i ′ = 1 {\displaystyle \sum _{i=1}^{n}{w_{i}'}=1} . For such normalized weights the weighted mean is then: x ¯ = ∑ i = 1 n w i ′ x i {\displaystyle {\bar {x}}=\sum _{i=1}^{n}{w_{i}'x_{i}}} . Note that one can always normalize the weights by making the following transformation on the original weights: w i ′ = w i ∑ j = 1 n w j {\displaystyle w_{i}'={\frac {w_{i}}{\sum _{j=1}^{n}{w_{j}}}}} . Using the normalized weight yields the same results as when using the original weights: x ¯ = ∑ i = 1 n w i ′ x i = ∑ i = 1 n w i ∑ j = 1 n w j x i = ∑ i = 1 n w i x i ∑ j = 1 n w j = ∑ i = 1 n w i x i ∑ i = 1 n w i . {\displaystyle {\begin{aligned}{\bar {x}}&=\sum _{i=1}^{n}w'_{i}x_{i}=\sum _{i=1}^{n}{\frac {w_{i}}{\sum _{j=1}^{n}w_{j}}}x_{i}={\frac {\sum _{i=1}^{n}w_{i}x_{i}}{\sum _{j=1}^{n}w_{j}}}\\&={\frac {\sum _{i=1}^{n}w_{i}x_{i}}{\sum _{i=1}^{n}w_{i}}}.\end{aligned}}} The ordinary mean 1 n ∑ i = 1 n x i {\displaystyle {\frac {1}{n}}\sum _{i=1}^{n}{x_{i}}} is a special case of the weighted mean where all data have equal weights. The standard error of the weighted mean (unit input variances), σ x ¯ {\displaystyle \sigma _{\bar {x}}} can be shown via uncertainty propagation to be: σ x ¯ = ( ∑ i = 1 n w i ) − 1 {\textstyle \sigma _{\bar {x}}=\left({\sqrt {\sum _{i=1}^{n}{w_{i}}}}\right)^{-1}} Statistical properties[edit] The weighted sample mean, x ¯ {\displaystyle {\bar {x}}} , is itself a random variable. Its expected value and standard deviation are related to the expected values and standard deviations of the observations, as follows. For simplicity, we assume normalized weights (weights summing to one). If the observations have expected values E ( x i ) = μ i , {\displaystyle E(x_{i})={\mu _{i}},} then the weighted sample mean has expectation E ( x ¯ ) = ∑ i = 1 n w i ′ μ i . {\displaystyle E({\bar {x}})=\sum _{i=1}^{n}{w_{i}'\mu _{i}}.} In particular, if the means are equal, μ i = μ {\displaystyle \mu _{i}=\mu } , then the expectation of the weighted sample mean will be that value, E ( x ¯ ) = μ . {\displaystyle E({\bar {x}})=\mu .} For uncorrelated observations with variances σ i 2 {\displaystyle \sigma _{i}^{2}} , the variance of the weighted sample mean is[citation needed] σ x ¯ 2 = ∑ i = 1 n w i ′ 2 σ i 2 {\displaystyle \sigma _{\bar {x}}^{2}=\sum _{i=1}^{n}{w_{i}'^{2}\sigma _{i}^{2}}} whose square root σ x ¯ {\displaystyle \sigma _{\bar {x}}} can be called the standard error of the weighted mean (general case).[citation needed] Consequently, if all the observations have equal variance, σ i 2 = σ 0 2 {\displaystyle \sigma _{i}^{2}=\sigma _{0}^{2}} , the weighted sample mean will have variance σ x ¯ 2 = σ 0 2 ∑ i = 1 n w i ′ 2 , {\displaystyle \sigma _{\bar {x}}^{2}=\sigma _{0}^{2}\sum _{i=1}^{n}{w_{i}'^{2}},} where 1 / n ≤ ∑ i = 1 n w i ′ 2 ≤ 1 {\textstyle 1/n\leq \sum _{i=1}^{n}{w_{i}'^{2}}\leq 1} . The variance attains its maximum value, σ 0 2 {\displaystyle \sigma _{0}^{2}} , when all weights except one are zero. Its minimum value is found when all weights are equal (i.e., unweighted mean), in which case we have σ x ¯ = σ 0 / n {\textstyle \sigma _{\bar {x}}=\sigma _{0}/{\sqrt {n}}} , i.e., it degenerates into the standard error of the mean, squared. Note that because one can always transform non-normalized weights to normalized weights all formula in this section can be adapted to non-normalized weights by replacing all w i ′ = w i ∑ i = 1 n w i {\displaystyle w_{i}'={\frac {w_{i}}{\sum _{i=1}^{n}{w_{i}}}}} . Variance weights[edit] See also: Inverse-variance_weighting See also: Weighted least squares For the weighted mean of a list of data for which each element x i {\displaystyle x_{i}} potentially comes from a different probability distribution with known variance σ i 2 {\displaystyle \sigma _{i}^{2}} , one possible choice for the weights is given by the reciprocal of variance: w i = 1 σ i 2 . {\displaystyle w_{i}={\frac {1}{\sigma _{i}^{2}}}.} The weighted mean in this case is: x ¯ = ∑ i = 1 n ( x i σ i 2 ) ∑ i = 1 n 1 σ i 2 , {\displaystyle {\bar {x}}={\frac {\sum _{i=1}^{n}\left({\dfrac {x_{i}}{\sigma _{i}^{2}}}\right)}{\sum _{i=1}^{n}{\dfrac {1}{\sigma _{i}^{2}}}}},} and the standard error of the weighted mean (with variance weights) is: σ x ¯ = 1 ∑ i = 1 n σ i − 2 , {\displaystyle \sigma _{\bar {x}}={\sqrt {\frac {1}{\sum _{i=1}^{n}\sigma _{i}^{-2}}}},} Note this reduces to σ x ¯ 2 = σ 0 2 / n {\displaystyle \sigma _{\bar {x}}^{2}=\sigma _{0}^{2}/n} when all σ i = σ 0 {\displaystyle \sigma _{i}=\sigma _{0}} . It is a special case of the general formula in previous section, σ x ¯ 2 = ∑ i = 1 n w i ′ 2 σ i 2 = ∑ i = 1 n σ i − 4 σ i 2 ( ∑ i = 1 n σ i − 2 ) 2 . {\displaystyle \sigma _{\bar {x}}^{2}=\sum _{i=1}^{n}{w_{i}'^{2}\sigma _{i}^{2}}={\frac {\sum _{i=1}^{n}{\sigma _{i}^{-4}\sigma _{i}^{2}}}{\left(\sum _{i=1}^{n}\sigma _{i}^{-2}\right)^{2}}}.} The equations above can be combined to obtain: x ¯ = σ x ¯ 2 ∑ i = 1 n x i σ i 2 . {\displaystyle {\bar {x}}=\sigma _{\bar {x}}^{2}\sum _{i=1}^{n}{\frac {x_{i}}{\sigma _{i}^{2}}}.} The significance of this choice is that this weighted mean is the maximum likelihood estimator of the mean of the probability distributions under the assumption that they are independent and normally distributed with the same mean. Correcting for over- or under-dispersion[edit] See also: § Weighted sample variance Weighted means are typically used to find the weighted mean of historical data, rather than theoretically generated data. In this case, there will be some error in the variance of each data point. Typically experimental errors may be underestimated due to the experimenter not taking into account all sources of error in calculating the variance of each data point. In this event, the variance in the weighted mean must be corrected to account for the fact that χ 2 {\displaystyle \chi ^{2}} is too large. The correction that must be made is σ ^ x ¯ 2 = σ x ¯ 2 χ ν 2 {\displaystyle {\hat {\sigma }}_{\bar {x}}^{2}=\sigma _{\bar {x}}^{2}\chi _{\nu }^{2}} where χ ν 2 {\displaystyle \chi _{\nu }^{2}} is the reduced chi-squared: χ ν 2 = 1 ( n − 1 ) ∑ i = 1 n ( x i − x ¯ ) 2 σ i 2 ; {\displaystyle \chi _{\nu }^{2}={\frac {1}{(n-1)}}\sum _{i=1}^{n}{\frac {(x_{i}-{\bar {x}})^{2}}{\sigma _{i}^{2}}};} The square root σ ^ x ¯ {\displaystyle {\hat {\sigma }}_{\bar {x}}} can be called the standard error of the weighted mean (variance weights, scale corrected). When all data variances are equal, σ i = σ 0 {\displaystyle \sigma _{i}=\sigma _{0}} , they cancel out in the weighted mean variance, σ x ¯ 2 {\displaystyle \sigma _{\bar {x}}^{2}} , which again reduces to the standard error of the mean (squared), σ x ¯ 2 = σ 2 / n {\displaystyle \sigma _{\bar {x}}^{2}=\sigma ^{2}/n} , formulated in terms of the sample standard deviation (squared), σ 2 = ∑ i = 1 n ( x i − x ¯ ) 2 n − 1 . {\displaystyle \sigma ^{2}={\frac {\sum _{i=1}^{n}(x_{i}-{\bar {x}})^{2}}{n-1}}.} Bootstrapping validation[edit] It has been shown by bootstrapping methods that the following is an accurate estimation for the square of the standard error of the mean (general case):[1] σ x ¯ 2 = n ( n − 1 ) w s 2 [ ∑ ( w i x i − w s x ¯ ) 2 − 2 x ¯ ∑ ( w i − w s ) ( w i x i − w s x ¯ ) + x ¯ 2 ∑ ( w i − w s ) 2 ] {\displaystyle \sigma _{\bar {x}}^{2}={\frac {n}{(n-1)w_{s}^{2}}}\left[\sum (w_{i}x_{i}-w_{s}{\bar {x}})^{2}-2{\bar {x}}\sum (w_{i}-w_{s})(w_{i}x_{i}-w_{s}{\bar {x}})+{\bar {x}}^{2}\sum (w_{i}-w_{s})^{2}\right]} where w s = ∑ w i {\displaystyle w_{s}=\sum w_{i}} . Further simplification leads to σ x ¯ 2 = n ( n − 1 ) w s 2 ∑ w i 2 ( x i − x ¯ ) 2 {\displaystyle \sigma _{\bar {x}}^{2}={\frac {n}{(n-1)w_{s}^{2}}}\sum w_{i}^{2}(x_{i}-{\bar {x}})^{2}} Weighted sample variance[edit] See also: § Correcting for over- or under-dispersion Typically when a mean is calculated it is important to know the variance and standard deviation about that mean. When a weighted mean μ ∗ {\displaystyle \mu ^{*}} is used, the variance of the weighted sample is different from the variance of the unweighted sample. The biased weighted sample variance σ ^ w 2 {\displaystyle {\hat {\sigma }}_{\mathrm {w} }^{2}} is defined similarly to the normal biased sample variance σ ^ 2 {\displaystyle {\hat {\sigma }}^{2}} : σ ^ 2   = ∑ i = 1 N ( x i − μ ) 2 N σ ^ w 2 = ∑ i = 1 N w i ( x i − μ ∗ ) 2 ∑ i = 1 N w i {\displaystyle {\begin{aligned}{\hat {\sigma }}^{2}\ &={\frac {\sum \limits _{i=1}^{N}\left(x_{i}-\mu \right)^{2}}{N}}\\{\hat {\sigma }}_{\mathrm {w} }^{2}&={\frac {\sum \limits _{i=1}^{N}w_{i}\left(x_{i}-\mu ^{*}\right)^{2}}{\sum _{i=1}^{N}w_{i}}}\end{aligned}}} where ∑ i = 1 N w i = 1 {\displaystyle \sum _{i=1}^{N}w_{i}=1} for normalized weights. If the weights are frequency weights (and thus are random variables), it can be shown that σ ^ w 2 {\displaystyle {\hat {\sigma }}_{\mathrm {w} }^{2}} is the maximum likelihood estimator of σ 2 {\displaystyle \sigma ^{2}} for iid Gaussian observations. For small samples, it is customary to use an unbiased estimator for the population variance. In normal unweighted samples, the N in the denominator (corresponding to the sample size) is changed to N − 1 (see Bessel's correction). In the weighted setting, there are actually two different unbiased estimators, one for the case of frequency weights and another for the case of reliability weights. Frequency weights[edit] If the weights are frequency weights (where a weight equals the number of occurrences), then the unbiased estimator is: s 2   = ∑ i = 1 N w i ( x i − μ ∗ ) 2 ∑ i = 1 N w i − 1 {\displaystyle {\begin{aligned}s^{2}\ &={\frac {\sum \limits _{i=1}^{N}w_{i}\left(x_{i}-\mu ^{*}\right)^{2}}{\sum _{i=1}^{N}w_{i}-1}}\end{aligned}}} This effectively applies Bessel's correction for frequency weights. For example, if values { 2 , 2 , 4 , 5 , 5 , 5 } {\displaystyle \{2,2,4,5,5,5\}} are drawn from the same distribution, then we can treat this set as an unweighted sample, or we can treat it as the weighted sample { 2 , 4 , 5 } {\displaystyle \{2,4,5\}} with corresponding weights { 2 , 1 , 3 } {\displaystyle \{2,1,3\}} , and we get the same result either way. If the frequency weights { w i } {\displaystyle \{w_{i}\}} are normalized to 1, then the correct expression after Bessel's correction becomes s 2   = ∑ i = 1 N w i ∑ i = 1 N w i − 1 ∑ i = 1 N w i ( x i − μ ∗ ) 2 {\displaystyle {\begin{aligned}s^{2}\ &={\frac {\sum _{i=1}^{N}w_{i}}{\sum _{i=1}^{N}w_{i}-1}}\sum _{i=1}^{N}w_{i}\left(x_{i}-\mu ^{*}\right)^{2}\end{aligned}}} where the total number of samples is ∑ i = 1 N w i {\displaystyle \sum _{i=1}^{N}w_{i}} (not N {\displaystyle N} ). In any case, the information on total number of samples is necessary in order to obtain an unbiased correction, even if w i {\displaystyle w_{i}} has a different meaning other than frequency weight. Note that the estimator can be unbiased only if the weights are not standardized nor normalized, these processes changing the data's mean and variance and thus leading to a loss of the base rate (the population count, which is a requirement for Bessel's correction). Reliability weights[edit] If the weights are instead non-random (reliability weights[definition needed]), we can determine a correction factor to yield an unbiased estimator. Assuming each random variable is sampled from the same distribution with mean μ {\displaystyle \mu } and actual variance σ actual 2 {\displaystyle \sigma _{\text{actual}}^{2}} , taking expectations we have, E ⁡ [ σ ^ 2 ] = ∑ i = 1 N E ⁡ [ ( x i − μ ) 2 ] N = E ⁡ [ ( X − E ⁡ [ X ] ) 2 ] − 1 N E ⁡ [ ( X − E ⁡ [ X ] ) 2 ] = ( N − 1 N ) σ actual 2 E ⁡ [ σ ^ w 2 ] = ∑ i = 1 N w i E ⁡ [ ( x i − μ ∗ ) 2 ] V 1 = E ⁡ [ ( X − E ⁡ [ X ] ) 2 ] − V 2 V 1 2 E ⁡ [ ( X − E ⁡ [ X ] ) 2 ] = ( 1 − V 2 V 1 2 ) σ actual 2 {\displaystyle {\begin{aligned}\operatorname {E} [{\hat {\sigma }}^{2}]&={\frac {\sum \limits _{i=1}^{N}\operatorname {E} [(x_{i}-\mu )^{2}]}{N}}\\&=\operatorname {E} [(X-\operatorname {E} [X])^{2}]-{\frac {1}{N}}\operatorname {E} [(X-\operatorname {E} [X])^{2}]\\&=\left({\frac {N-1}{N}}\right)\sigma _{\text{actual}}^{2}\\\operatorname {E} [{\hat {\sigma }}_{\mathrm {w} }^{2}]&={\frac {\sum \limits _{i=1}^{N}w_{i}\operatorname {E} [(x_{i}-\mu ^{*})^{2}]}{V_{1}}}\\&=\operatorname {E} [(X-\operatorname {E} [X])^{2}]-{\frac {V_{2}}{V_{1}^{2}}}\operatorname {E} [(X-\operatorname {E} [X])^{2}]\\&=\left(1-{\frac {V_{2}}{V_{1}^{2}}}\right)\sigma _{\text{actual}}^{2}\end{aligned}}} where V 1 = ∑ i = 1 N w i {\displaystyle V_{1}=\sum _{i=1}^{N}w_{i}} and V 2 = ∑ i = 1 N w i 2 {\displaystyle V_{2}=\sum _{i=1}^{N}w_{i}^{2}} . Therefore, the bias in our estimator is ( 1 − V 2 V 1 2 ) {\displaystyle \left(1-{\frac {V_{2}}{V_{1}^{2}}}\right)} , analogous to the ( N − 1 N ) {\displaystyle \left({\frac {N-1}{N}}\right)} bias in the unweighted estimator (also notice that   V 1 2 / V 2 = N e f f {\displaystyle \ V_{1}^{2}/V_{2}=N_{eff}} is the effective sample size). This means that to unbias our estimator we need to pre-divide by 1 − ( V 2 / V 1 2 ) {\displaystyle 1-\left(V_{2}/V_{1}^{2}\right)} , ensuring that the expected value of the estimated variance equals the actual variance of the sampling distribution. The final unbiased estimate of sample variance is: s w 2   = σ ^ w 2 1 − ( V 2 / V 1 2 ) = ∑ i = 1 N w i ( x i − μ ∗ ) 2 V 1 − ( V 2 / V 1 ) {\displaystyle {\begin{aligned}s_{\mathrm {w} }^{2}\ &={\frac {{\hat {\sigma }}_{\mathrm {w} }^{2}}{1-(V_{2}/V_{1}^{2})}}\\&={\frac {\sum \limits _{i=1}^{N}w_{i}(x_{i}-\mu ^{*})^{2}}{V_{1}-(V_{2}/V_{1})}}\end{aligned}}} ,[2] where E ⁡ [ s w 2 ] = σ actual 2 {\displaystyle \operatorname {E} [s_{\mathrm {w} }^{2}]=\sigma _{\text{actual}}^{2}} . The degrees of freedom of the weighted, unbiased sample variance vary accordingly from N − 1 down to 0. The standard deviation is simply the square root of the variance above. As a side note, other approaches have been described to compute the weighted sample variance.[3] Weighted sample covariance[edit] In a weighted sample, each row vector x i {\displaystyle \textstyle {\textbf {x}}_{i}} (each set of single observations on each of the K random variables) is assigned a weight w i ≥ 0 {\displaystyle \textstyle w_{i}\geq 0} . Then the weighted mean vector μ ∗ {\displaystyle \textstyle \mathbf {\mu ^{*}} } is given by μ ∗ = ∑ i = 1 N w i x i ∑ i = 1 N w i . {\displaystyle \mathbf {\mu ^{*}} ={\frac {\sum _{i=1}^{N}w_{i}\mathbf {x} _{i}}{\sum _{i=1}^{N}w_{i}}}.} And the weighted covariance matrix is given by:[4] C = ∑ i = 1 N w i ( x i − μ ∗ ) T ( x i − μ ∗ ) V 1 . {\displaystyle {\begin{aligned}\mathbf {C} &={\frac {\sum _{i=1}^{N}w_{i}\left(\mathbf {x} _{i}-\mu ^{*}\right)^{T}\left(\mathbf {x} _{i}-\mu ^{*}\right)}{V_{1}}}.\end{aligned}}} Similarly to weighted sample variance, there are two different unbiased estimators depending on the type of the weights. Frequency weights[edit] If the weights are frequency weights, the unbiased weighted estimate of the covariance matrix C {\displaystyle \textstyle \mathbf {C} } , with Bessel's correction, is given by:[4] C = ∑ i = 1 N w i ( x i − μ ∗ ) T ( x i − μ ∗ ) V 1 − 1 . {\displaystyle {\begin{aligned}\mathbf {C} &={\frac {\sum _{i=1}^{N}w_{i}\left(\mathbf {x} _{i}-\mu ^{*}\right)^{T}\left(\mathbf {x} _{i}-\mu ^{*}\right)}{V_{1}-1}}.\end{aligned}}} Note that this estimator can be unbiased only if the weights are not standardized nor normalized, these processes changing the data's mean and variance and thus leading to a loss of the base rate (the population count, which is a requirement for Bessel's correction). Reliability weights[edit] In the case of reliability weights, the weights are normalized: V 1 = ∑ i = 1 N w i = 1. {\displaystyle V_{1}=\sum _{i=1}^{N}w_{i}=1.} (If they are not, divide the weights by their sum to normalize prior to calculating V 1 {\displaystyle V_{1}} : w i ′ = w i ∑ i = 1 N w i {\displaystyle w_{i}'={\frac {w_{i}}{\sum _{i=1}^{N}w_{i}}}} Then the weighted mean vector μ ∗ {\displaystyle \textstyle \mathbf {\mu ^{*}} } can be simplified to μ ∗ = ∑ i = 1 N w i x i . {\displaystyle \mathbf {\mu ^{*}} =\sum _{i=1}^{N}w_{i}\mathbf {x} _{i}.} and the unbiased weighted estimate of the covariance matrix C {\displaystyle \textstyle \mathbf {C} } is:[5] C = ∑ i = 1 N w i ( ∑ i = 1 N w i ) 2 − ∑ i = 1 N w i 2 ∑ i = 1 N w i ( x i − μ ∗ ) T ( x i − μ ∗ ) = ∑ i = 1 N w i ( x i − μ ∗ ) T ( x i − μ ∗ ) V 1 − ( V 2 / V 1 ) . {\displaystyle {\begin{aligned}\mathbf {C} &={\frac {\sum _{i=1}^{N}w_{i}}{\left(\sum _{i=1}^{N}w_{i}\right)^{2}-\sum _{i=1}^{N}w_{i}^{2}}}\sum _{i=1}^{N}w_{i}\left(\mathbf {x} _{i}-\mu ^{*}\right)^{T}\left(\mathbf {x} _{i}-\mu ^{*}\right)\\&={\frac {\sum _{i=1}^{N}w_{i}\left(\mathbf {x} _{i}-\mu ^{*}\right)^{T}\left(\mathbf {x} _{i}-\mu ^{*}\right)}{V_{1}-(V_{2}/V_{1})}}.\end{aligned}}} The reasoning here is the same as in the previous section. Since we are assuming the weights are normalized, then V 1 = 1 {\displaystyle V_{1}=1} and this reduces to: C = ∑ i = 1 N w i ( x i − μ ∗ ) T ( x i − μ ∗ ) 1 − V 2 . {\displaystyle \mathbf {C} ={\frac {\sum _{i=1}^{N}w_{i}\left(\mathbf {x} _{i}-\mu ^{*}\right)^{T}\left(\mathbf {x} _{i}-\mu ^{*}\right)}{1-V_{2}}}.} If all weights are the same, i.e. w i / V 1 = 1 / N {\displaystyle \textstyle w_{i}/V_{1}=1/N} , then the weighted mean and covariance reduce to the unweighted sample mean and covariance above. Vector-valued estimates[edit] The above generalizes easily to the case of taking the mean of vector-valued estimates. For example, estimates of position on a plane may have less certainty in one direction than another. As in the scalar case, the weighted mean of multiple estimates can provide a maximum likelihood estimate. We simply replace the variance σ 2 {\displaystyle \sigma ^{2}} by the covariance matrix C {\displaystyle \mathbf {C} } and the arithmetic inverse by the matrix inverse (both denoted in the same way, via superscripts); the weight matrix then reads:[6] W i = C i − 1 . {\displaystyle \mathbf {W} _{i}=\mathbf {C} _{i}^{-1}.} The weighted mean in this case is: x ¯ = C x ¯ ( ∑ i = 1 n W i x i ) , {\displaystyle {\bar {\mathbf {x} }}=\mathbf {C} _{\bar {\mathbf {x} }}\left(\sum _{i=1}^{n}\mathbf {W} _{i}\mathbf {x} _{i}\right),} (where the order of the matrix-vector product is not commutative), in terms of the covariance of the weighted mean: C x ¯ = ( ∑ i = 1 n W i ) − 1 , {\displaystyle \mathbf {C} _{\bar {\mathbf {x} }}=\left(\sum _{i=1}^{n}\mathbf {W} _{i}\right)^{-1},} For example, consider the weighted mean of the point [1 0] with high variance in the second component and [0 1] with high variance in the first component. Then x 1 := [ 1 0 ] ⊤ , C 1 := [ 1 0 0 100 ] {\displaystyle \mathbf {x} _{1}:={\begin{bmatrix}1&0\end{bmatrix}}^{\top },\qquad \mathbf {C} _{1}:={\begin{bmatrix}1&0\\0&100\end{bmatrix}}} x 2 := [ 0 1 ] ⊤ , C 2 := [ 100 0 0 1 ] {\displaystyle \mathbf {x} _{2}:={\begin{bmatrix}0&1\end{bmatrix}}^{\top },\qquad \mathbf {C} _{2}:={\begin{bmatrix}100&0\\0&1\end{bmatrix}}} then the weighted mean is: x ¯ = ( C 1 − 1 + C 2 − 1 ) − 1 ( C 1 − 1 x 1 + C 2 − 1 x 2 ) = [ 0.9901 0 0 0.9901 ] [ 1 1 ] = [ 0.9901 0.9901 ] {\displaystyle {\begin{aligned}{\bar {\mathbf {x} }}&=\left(\mathbf {C} _{1}^{-1}+\mathbf {C} _{2}^{-1}\right)^{-1}\left(\mathbf {C} _{1}^{-1}\mathbf {x} _{1}+\mathbf {C} _{2}^{-1}\mathbf {x} _{2}\right)\\[5pt]&={\begin{bmatrix}0.9901&0\\0&0.9901\end{bmatrix}}{\begin{bmatrix}1\\1\end{bmatrix}}={\begin{bmatrix}0.9901\\0.9901\end{bmatrix}}\end{aligned}}} which makes sense: the [1 0] estimate is "compliant" in the second component and the [0 1] estimate is compliant in the first component, so the weighted mean is nearly [1 1]. Accounting for correlations[edit] See also: Generalized least squares and Variance § Sum of correlated variables In the general case, suppose that X = [ x 1 , … , x n ] T {\displaystyle \mathbf {X} =[x_{1},\dots ,x_{n}]^{T}} , C {\displaystyle \mathbf {C} } is the covariance matrix relating the quantities x i {\displaystyle x_{i}} , x ¯ {\displaystyle {\bar {x}}} is the common mean to be estimated, and J {\displaystyle \mathbf {J} } is a design matrix equal to a vector of ones [ 1 , . . . , 1 ] T {\displaystyle [1,...,1]^{T}} (of length n {\displaystyle n} ). The Gauss–Markov theorem states that the estimate of the mean having minimum variance is given by: σ x ¯ 2 = ( J T W J ) − 1 , {\displaystyle \sigma _{\bar {x}}^{2}=(\mathbf {J} ^{T}\mathbf {W} \mathbf {J} )^{-1},} and x ¯ = σ x ¯ 2 ( J T W X ) , {\displaystyle {\bar {x}}=\sigma _{\bar {x}}^{2}(\mathbf {J} ^{T}\mathbf {W} \mathbf {X} ),} where: W = C − 1 . {\displaystyle \mathbf {W} =\mathbf {C} ^{-1}.} Decreasing strength of interactions[edit] Consider the time series of an independent variable x {\displaystyle x} and a dependent variable y {\displaystyle y} , with n {\displaystyle n} observations sampled at discrete times t i {\displaystyle t_{i}} . In many common situations, the value of y {\displaystyle y} at time t i {\displaystyle t_{i}} depends not only on x i {\displaystyle x_{i}} but also on its past values. Commonly, the strength of this dependence decreases as the separation of observations in time increases. To model this situation, one may replace the independent variable by its sliding mean z {\displaystyle z} for a window size m {\displaystyle m} . z k = ∑ i = 1 m w i x k + 1 − i . {\displaystyle z_{k}=\sum _{i=1}^{m}w_{i}x_{k+1-i}.} Exponentially decreasing weights[edit] See also: Exponentially weighted moving average In the scenario described in the previous section, most frequently the decrease in interaction strength obeys a negative exponential law. If the observations are sampled at equidistant times, then exponential decrease is equivalent to decrease by a constant fraction 0 < Δ < 1 {\displaystyle 0<\Delta <1} at each time step. Setting w = 1 − Δ {\displaystyle w=1-\Delta } we can define m {\displaystyle m} normalized weights by w i = w i − 1 V 1 , {\displaystyle w_{i}={\frac {w^{i-1}}{V_{1}}},} where V 1 {\displaystyle V_{1}} is the sum of the unnormalized weights. In this case V 1 {\displaystyle V_{1}} is simply V 1 = ∑ i = 1 m w i − 1 = 1 − w m 1 − w , {\displaystyle V_{1}=\sum _{i=1}^{m}{w^{i-1}}={\frac {1-w^{m}}{1-w}},} approaching V 1 = 1 / ( 1 − w ) {\displaystyle V_{1}=1/(1-w)} for large values of m {\displaystyle m} . The damping constant w {\displaystyle w} must correspond to the actual decrease of interaction strength. If this cannot be determined from theoretical considerations, then the following properties of exponentially decreasing weights are useful in making a suitable choice: at step ( 1 − w ) − 1 {\displaystyle (1-w)^{-1}} , the weight approximately equals e − 1 ( 1 − w ) = 0.39 ( 1 − w ) {\displaystyle {e^{-1}}(1-w)=0.39(1-w)} , the tail area the value e − 1 {\displaystyle e^{-1}} , the head area 1 − e − 1 = 0.61 {\displaystyle {1-e^{-1}}=0.61} . The tail area at step n {\displaystyle n} is ≤ e − n ( 1 − w ) {\displaystyle \leq {e^{-n(1-w)}}} . Where primarily the closest n {\displaystyle n} observations matter and the effect of the remaining observations can be ignored safely, then choose w {\displaystyle w} such that the tail area is sufficiently small. Weighted averages of functions[edit] The concept of weighted average can be extended to functions.[7] Weighted averages of functions play an important role in the systems of weighted differential and integral calculus.[8] See also[edit] Average Central tendency Mean Standard deviation Summary statistics Weight function Weighted average cost of capital Weighted geometric mean Weighted harmonic mean Weighted least squares Weighted median Weighting Standard error of a proportion estimation when using weighted data References[edit] ^ Gatz, Donald F.; Smith, Luther (June 1995). "The standard error of a weighted mean concentration—I. Bootstrapping vs other methods". Atmospheric Environment. 29 (11): 1185–1193. doi:10.1016/1352-2310(94)00210-C. ^ "GNU Scientific Library – Reference Manual: Weighted Samples". Gnu.org. Retrieved 22 December 2017. ^ "Weighted Standard Error and its Impact on Significance Testing (WinCross vs. Quantum & SPSS), Dr. Albert Madansky" (PDF). Analyticalgroup.com. Retrieved 22 December 2017. ^ a b Price, George R. (April 1972). "Extension of covariance selection mathematics" (PDF). Annals of Human Genetics. 35 (4): 485–490. doi:10.1111/j.1469-1809.1957.tb01874.x. ^ Mark Galassi, Jim Davies, James Theiler, Brian Gough, Gerard Jungman, Michael Booth, and Fabrice Rossi. GNU Scientific Library - Reference manual, Version 1.15, 2011. Sec. 21.7 Weighted Samples ^ James, Frederick (2006). Statistical Methods in Experimental Physics (2nd ed.). Singapore: World Scientific. p. 324. ISBN 981-270-527-9. ^ G. H. Hardy, J. E. Littlewood, and G. Pólya. Inequalities (2nd ed.), Cambridge University Press, ISBN 978-0-521-35880-4, 1988. ^ Jane Grossman, Michael Grossman, Robert Katz. The First Systems of Weighted Differential and Integral Calculus, ISBN 0-9771170-1-4, 1980. Further reading[edit] Bevington, Philip R (1969). Data Reduction and Error Analysis for the Physical Sciences. New York, N.Y.: McGraw-Hill. OCLC 300283069. Strutz, T. (2010). Data Fitting and Uncertainty (A practical introduction to weighted least squares and beyond). Vieweg+Teubner. ISBN 978-3-8348-1022-9. External links[edit] David Terr. "Weighted Mean". MathWorld. Tool to calculate Weighted Average